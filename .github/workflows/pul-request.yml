name: Auto Merge Develop to Main

on:
  schedule:
    # Runs at 02:00 UTC every day Monday-Friday
    - cron: '0 2 * * 1-5'

jobs:
  pull-request:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Create pull request
      uses: diillson/auto-pull-request@v1.0.1
      with:
        source_branch: "develop"
        destination_branch: "main"
        pr_title: "Automated PR: Merge develop into main"
        pr_body: |
          :robot: This is an automated pull request merging **develop** into **main**.

          _Created by [diillson/auto-pull-request](https://github.com/diillson/auto-pull-request)_
        pr_template: ".github/PULL_REQUEST_TEMPLATE.md"
        pr_reviewer: "diillson,worker"
        pr_assignee: "diillson,worker"
        pr_label: "auto-pr"
        pr_milestone: "Milestone 1"
        pr_draft: false
        pr_allow_empty: false
        github_token: ${{ secrets.CUSTOM_GH_TOKEN }}

    - name: Auto merge pull request
      uses: pascalgn/automerge-action@v0.16.3
      env:
        GITHUB_TOKEN: ${{ secrets.CUSTOM_GH_TOKEN }}
